from io import StringIO
import xmldict
from twisted.internet import reactor
from twisted.web.client import Agent
from twisted.web.http_headers import Headers
from twisted.web.client import FileBodyProducer
#from xml_dict import bm_xml
xml_str = bm_xml()
agent = Agent(reactor)
body = FileBodyProducer(StringIO(xml_str))
d = agent.request(
   'GET',
   'http://localhost:8080/',
    Headers({'User-Agent': ['cwmp'],
            'Content-Type': ['text/xml']}),
    body)
def cbResponse(response):
    print (response.version)
d.addCallback(cbResponse)
def cbShutdown(ignored):
   reactor.stop()
d.addBoth(cbShutdown)
reactor.run()
